<%= form_for(@post) do |f| %>
  <% if @post.errors.any? %>
  <div class="alert alert-danger alert-dismissable">
    <button type="button" class="close" data-dismiss="alert" aria-hidden="true">Ã—</button>
    <h4><%= pluralize(@post.errors.count, "error") %> prohibited this post from being saved:</h4>
    <p>
      <ul>
        <% @post.errors.full_messages.each do |message| %>
        <li><%= message %></li>
        <% end %>
      </ul>
    </p>
  </div>
  <% end %>

  <div class="form-group">
    <%= f.text_field :title, class:"form-control", placeholder: "Post Title ..." %>
  </div>

  <div class="form-group">
    <%= f.label :body, class:"control-label" %>

    <%= f.text_area :body, class:"form-control body-edit", rows: 15, placeholder: "Write Post body ..." %>
  </div>

  <div class="form-group">
    <span class="btn btn-success fileinput-button">
      <i class="glyphicon glyphicon-plus"></i>
      <span>Add Images...</span>
      <%= f.fields_for :pictures do |pic| %>
        <%= pic.file_field :pic, multiple:true, name: "pictures[pic][]", class:"post_pictures_attributes_pic" %>
      <% end %>
    </span>
    <ul class="list-inline" id="uploadPreview">
      <% if @post.pictures.all %>
        <% @post.pictures.all.each do |p| %>
        <li class='list-group-item'><%= image_tag p.pic_url(:thumb), class:"img-rounded" %></li>
        <% end %>
      <% end %>
    </ul>
  </div>

  <div class="actions">
    <%= f.submit "Save", class:"btn btn-primary btn-block" %>
  </div>
<% end %>

<script type="text/javascript">
  $(document).ready(function(){
    $('.body-edit').wysihtml5({
      'locale': "zh-CN"
    });
  })
</script>
